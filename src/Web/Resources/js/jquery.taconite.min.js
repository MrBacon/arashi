(function(E){E.taconite=function(G){C(G)};E.taconite.debug=0;E.taconite.version="3.07";E.taconite.defaults={cdataWrap:"div"};if(typeof E.fn.replace=="undefined"){E.fn.replace=function(G){return this.after(G).remove()}}if(typeof E.fn.replaceContent=="undefined"){E.fn.replaceContent=function(G){return this.empty().append(G)}}E.expr[":"].taconiteTag=function(G){return G.taconiteTag===1};E.taconite._httpData=E.httpData;E.httpData=E.taconite.detect=function(J,H){var G=J.getResponseHeader("content-type");if(E.taconite.debug){A("[AJAX response] content-type: ",G,";  status: ",J.status," ",J.statusText,";  has responseXML: ",J.responseXML!=null);A("type: "+H);A("responseXML: "+J.responseXML)}var I=E.taconite._httpData(J,H);if(I&&I.documentElement){E.taconite(I)}else{A("jQuery core httpData returned: "+I);A('httpData: response is not XML (or not "valid" XML)')}return I};E.taconite.enableAutoDetection=function(G){E.httpData=G?E.taconite.detect:E.taconite._httpData};var D=0;function A(){if(!E.taconite.debug||!window.console||!window.console.log){return }if(!D++){A("Plugin Version: "+E.taconite.version)}window.console.log("[taconite] "+[].join.call(arguments,""))}function C(J){var H=true,K;try{if(typeof J=="string"){J=F(J)}if(!J){A("$.taconite invoked without valid document; nothing to process");return false}var G=J.documentElement.tagName;A("XML document root: ",G);var I=E("taconite",J)[0];if(!I){A("document does not contain <taconite> element; nothing to process");return false}E.event.trigger("taconite-begin-notify",[I]);H=B(I)}catch(L){H=K=L}E.event.trigger("taconite-complete-notify",[J,!!H,H===true?null:H]);if(K){throw K}}function F(H){var J;A("attempting string to document conversion");try{if(window.DOMParser){var K=new DOMParser();J=K.parseFromString(H,"text/xml")}else{J=E("<xml>")[0];J.async="false";J.loadXML(H)}}catch(I){if(window.console&&window.console.error){window.console.error("[taconite] ERROR parsing XML string for conversion: "+I)}throw I}var G=J&&J.documentElement&&J.documentElement.tagName!="parsererror";A("conversion ",G?"successful!":"FAILED");return J}function B(G){var K={wrap:1};try{var H=new Date().getTime();I(G.childNodes);E.taconite.lastTime=(new Date().getTime())-H;A("time to process response: "+E.taconite.lastTime+"ms")}catch(J){if(window.console&&window.console.error){window.console.error("[taconite] ERROR processing document: "+J)}throw J}return true;function I(Q){var Y=0;for(var d=0;d<Q.length;d++){if(Q[d].nodeType!=1){continue}var M=Q[d],b=M.tagName;if(b=="eval"){var U=(M.firstChild?M.firstChild.nodeValue:null);A('invoking "eval" command: ',U);if(U){E.globalEval(U)}continue}var T=M.getAttribute("select");var X=E(T);if(!X[0]){A("No matching targets for selector: ",T);continue}var S=M.getAttribute("cdataWrap")||E.taconite.defaults.cdataWrap;var e=[];if(M.childNodes.length>0){Y=1;for(var Z=0,O=[];Z<M.childNodes.length;Z++){O[Z]=h(M.childNodes[Z])}e.push(K[b]?f(O):O)}var W=M.getAttribute("name");var R=M.getAttribute("value");if(W!==null){e.push(W)}if(R!==null){e.push(R)}for(var Z=1;true;Z++){R=M.getAttribute("arg"+Z);if(R===null){break}e.push(R)}if(E.taconite.debug){var P=O?"...":e.join(",");A("invoking command: $('",T,"').",b,"("+P+")")}X[b].apply(X,e)}if(Y){c()}function c(){if(E.browser.mozilla){return }E("select:taconiteTag").each(function(){var a=this;E("option:taconiteTag",this).each(function(){this.setAttribute("selected","selected");this.taconiteTag=null;if(a.type=="select-one"){var i=E("option",a).index(this);a.selectedIndex=i}});this.taconiteTag=null})}function f(l){for(var k=0,j=[];k<l.length;k++){if(l[k].nodeType==1){j.push(l[k])}}return j}function h(i){var a=i.nodeType;if(a==1){return V(i)}if(a==3){return g(i.nodeValue)}if(a==4){return L(i.nodeValue)}return null}function L(k){var j=document.createElement(S);j.innerHTML=k;var i=E(j),a=i.children();if(a.size()==1){return a[0]}return j}function g(a){if(E.browser.msie){a=a.replace(/\n/g,"\r").replace(/\s+/g," ")}return document.createTextNode(a)}function V(m){var n,j=m.tagName.toLowerCase();if(E.browser.msie){var l=m.getAttribute("type");if(j=="table"||l=="radio"||l=="checkbox"||j=="button"||(j=="select"&&m.getAttribute("multiple"))){n=document.createElement("<"+j+" "+N(null,m,true)+">")}}if(!n){n=document.createElement(j);N(n,m)}if(E.browser.msie&&j=="td"){var p=m.getAttribute("colspan");if(p){n.colSpan=parseInt(p)}}if(E.browser.msie&&!n.canHaveChildren){if(m.childNodes.length>0){n.text=m.text}}else{for(var k=0,a=m.childNodes.length;k<a;k++){var o=h(m.childNodes[k]);if(o){n.appendChild(o)}}}if(!E.browser.mozilla){if(j=="select"||(j=="option"&&m.getAttribute("selected"))){n.taconiteTag=1}}return n}function N(m,q,p){for(var o=0,j="";o<q.attributes.length;o++){var k=q.attributes[o],r=E.trim(k.name),l=E.trim(k.value);if(p){j+=(r+'="'+l+'" ')}else{if(r=="style"){m.style.cssText=l;m.setAttribute(r,l)}else{E.attr(m,r,l)}}}return j}}}})(jQuery);