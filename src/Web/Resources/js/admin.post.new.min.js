$(function(){$("#post-edit-tags a").button();$("#post-edit-publish").click(function(){showPostEditMenu($("#post-edit-publish"),$("#menu-publish"))});$("#post-edit-tags").click(function(){showPostEditMenu($("#post-edit-tags"),$("#menu-tags"))});$("#post-edit-categories").click(function(){showPostEditMenu($("#post-edit-categories"),$("#menu-categories"))});$("#showSummaryLink").click(function(){$(this).hide();$("#summaryFieldset").slideToggle()});$("#addNewCategoryLink").click(function(){$("#newCategoryPanel").slideToggle()});$("#submitNewTagLink").click(function(){postNewTag()});$("#submitNewCategoryLink").click(function(){postNewCategory()});setTagCheckListEvents();$("#tab-tag-selection").tabs();$("#tab-tag-selection").removeClass("ui-widget");$("#all-tags-select").change(function(){var A=$("option:selected",this);if(A.val()!=""){addTagToPost(A.val(),A.text());$(this).val(0)}});getTagCloud()});function showPostEditMenu(B,A){if(A.is(":hidden")){A.css({top:0,left:0});A.position({my:"left top",at:"left bottom",of:B,offset:"0 0"});A.show();B.removeClass("ui-corner-all");B.addClass("ui-corner-top");A.removeClass("ui-corner-all");A.addClass("ui-corner-bottom");A.addClass("ui-corner-tr")}else{A.hide();B.removeClass("ui-corner-top");B.addClass("ui-corner-all");A.removeClass("ui-corner-bottom");A.removeClass("ui-corner-tr");A.addClass("ui-corner-all")}}function postNewTag(){$.post(urlSaveNewTag,{Name:$("#newtagform input#TagName").val()},function(A){showMessage(A);$("#newtagform input#TagName").val("");getTagCloud()})}function postNewCategory(){var A=$("#newcategoryform input#CategoryName").val();var B=$("#newcategoryform select#ParentCategory").val();if(_isNull(A)){growl("To add a new category you must specify the name!",true,true);return false}$.post(urlSaveNewCategory,{Name:A,parentCategoryId:B},function(C){showMessage(C);$("#newcategoryform input#CategoryName").val("");$("#newcategoryform select#ParentCategory").val("")})}function addTagToPost(D,E){if($("#tagchecklist").find("li .tag input[value="+D+"]").length>0){return }var C="tagid-"+D;var G=$("<li></li>");var F=$("<input type='hidden' id='"+C+"' name='tagid' value='"+D+"'/>");var B=$("<div class='tag'>"+E+"</div>");var A=$("<a class='tag-remove' href='#' title='Remove this tag'><span class='ui-icon ui-icon-circle-close'></span>remove</a>");B.append(F);G.append(B).append(A);$("#tagchecklist").append(G);$("#tagchecklist-empty").hide();setTagCheckListEvents()}function getTagCloud(){$.get(urlGetTagCloud,function(A){if(A!=""){$("#tabPopular").empty().append(A);$("#tabPopular a").unbind();$("#tabPopular a").click(function(){addTagToPost($(this).attr("rel"),$(this).text())})}})}function setTagCheckListEvents(){$("#tagchecklist li").unbind();$("#tagchecklist li").hover(function(){$("a.tag-remove",this).show()},function(){$("a.tag-remove",this).hide()});$("#tagchecklist li a.tag-remove").unbind();$("#tagchecklist li a.tag-remove").click(function(){$(this).parent().remove()})};